% primary responsibility: Phil

\subsection{Blocking}

Figure~\ref{fig:rule_syntax} shows the general syntax for a Snort rules. There are eight types of snort rules: alert, log, pass, active, dynamic, drop, reject, and sdrop. Each type is described below:

\begin{itemize}
    \item \textbf{Alert}.
        Alert is the most commonly used type of rule. It sends an alert to the
        network to who ever is running the Snort server \emph{and} logs the
        packet(s) for later inspection.

    \item \textbf{Log}.
        Log logs the packet, but does not send an alert.  This can be used for
        a rule that is not critical but the network administrator wants to be
        able to look at it later.

    \item \textbf{Pass}.
        Pass does not do anything with the packet. The packet is ignored.

    \item \textbf{Active}.
        The is the same as Alert except that after sending an alert, a dynamic
        rule is turned on.

    \item \textbf{Dynamic}.
        A dynamic rule will do nothing until activated by an Active rule. Once
        it has been activated, it asks as a log rule

    \item \textbf{Drop}.
        Drop blocks the packet and logs it.

    \item \textbf{Reject}.
        Reject blocks the packet, logs it, and sends a TCP reset message (for a
        TCP connection) or a ICMP port unreachable message (for UDP connection)
        to both ends of the connect.

    \item \textbf{sDrop}.
        Same as Drop except that the packet is not logged.
\end{itemize}

For the purposes of blocking websites, we are interested in drop, reject, and
sdrop. We want to be record when a website is being blocked (we want the packet
logged), sdrop does not fit our needs. For drop to work correctly, Snort needs
to configured in inline mode. Inline mode is when the Snort server is inline
with Internet traffic. For example, the Snort server would be between the local
network and the Internet connection. Add data is inspected by the server and
either blocked or passed through. As our design section describes, this
configuration has important implications. This means that if the Snort server
fails then the Internet connection will be lost. This also means that the Snort
server could potentially act as a bottle neck, slow down traffic. Because of
these reasons, we decided that putting Snort inline in the network did not fit
our needs. This means that block is not a valid action.

The last rule action is reject. Since we are concerned about rejecting HTTP
requests, we concern ourselves with only the TCP functionality of reject and
ignore the UDP functionality. Reject uses a well studied TCP attack called TCP
Reset attack~\cite{XXX}.

For a TCP Reset attack to work, there must be a man in the middle. It monitors
the TCP connections that are being made between the network and the Internet.
When the man in the middle wants to top a connection, it sends a TCP RST packet
to both ends of the connections. Both ends of the connection think that the
packet came from the other end so it honors the RST packet. For this to work,
the man in the middle must know the sequence number and ACK number of the TCP
stream. This can easily be found by looking at the header of TCP packets. Once
both ends of the connect receive the TCP RST packet, they stop sending data and
close the connection. Figure~\ref{fig:tcp_reset} shows a packet flow of a TCP
reset attack.

For the cause of Snort, the Snort server is the man in the middle. When a
reject rule is triggered, the Snort server sends a TCP RST packet to each end
of the connection.




\begin{figure}[!t]
    \centering
    \includegraphics[width=.8\columnwidth]{figures/tcp_reset}
    \caption{The flow of how a TCP RST attack works in our system. When the
    Snort server detects a HTTP GET request, the Snort server sends a TCP RST
    packet to both ends of the connection (Client and Server).}
    \label{fig:tcp_reset}
\end{figure}

\begin{figure}[!t]
    \centering
    \includegraphics[width=\columnwidth]{figures/snort_slow}
    \caption{XXX: Put caption here}
    \label{fig:snort_slow}
\end{figure}
